{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS",
    "buildCommand": "pip install -e ."
  },
  "deploy": {
    "startCommand": "python3 -c \"import os; import subprocess; api_proc = subprocess.Popen(['python3', 'compita-cli.py', 'api', '--host', '0.0.0.0', '--port', os.environ.get('PORT', '8000')]); web_proc = subprocess.Popen(['python3', 'compita-cli.py', 'web', '--host', '0.0.0.0', '--port', '8080', '--api-url', f\"http://localhost:{os.environ.get('PORT', '8000')}\"]); api_proc.wait()\"",
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
